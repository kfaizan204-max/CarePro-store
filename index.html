<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Simple Stock Test</title>
</head>
<body>
<h2>Stock Test</h2>
<input type="text" id="item" placeholder="Item">
<input type="number" id="qty" placeholder="Quantity">
<button onclick="saveStock()">Save to Stock</button>

<h3>Sheet Data</h3>
<ul id="dataList"></ul>

<script>
const API_URL = "https://sheetdb.io/api/v1/2y1u7hp9ykzlq?sheet=Stock"; // Stock sheet only

async function saveStock(){
  const item = document.getElementById('item').value;
  const qty = document.getElementById('qty').value;
  if(!item || !qty) return alert("Fill both fields");

  const data = {
    data: [
      { Item: item, Added: qty, Delivered: 0, Available: qty }
    ]
  };

  try {
    const res = await fetch(API_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });
    if(res.ok) alert("✅ Saved!");
    else alert("❌ Failed to save.");
    loadStock();
  } catch(err) {
    console.error(err);
    alert("❌ Network or API error.");
  }
}

async function loadStock(){
  try {
    const res = await fetch(API_URL);
    const data = await res.json();
    const list = document.getElementById('dataList');
    list.innerHTML = "";
    data.forEach(r=>{
      const li = document.createElement('li');
      li.textContent = `${r.Item} - ${r.Added} - ${r.Delivered} - ${r.Available}`;
      list.appendChild(li);
    });
  } catch(err) {
    console.error(err);
  }
}

// load data on page load
loadStock();
</script>
</body>
</html>
